---
  title: "Dr.Shah NS5 and polyIC samples"
output:
  pdf_document: default
word_document: default
html_document: default
---
  
__Author:__ Amanda Everitt  

#[analysis done on seperate R script]
- make sure to place Rdata object in same directory as this script


****************************************************************************************************

#Boxplot of log2FC distributions
```{r}
setwd("~/projects/AmpliSeq_Analysis/07_dengue_chip20.21/results/polyIC/plotting")
library(ggplot2)
library(ggpubr)

load("boxplot_df.Rdata")

p <- ggplot(boxplot_df, aes(x=Set, y=value, fill=variable)) + 
  geom_boxplot(outlier.size = 0.5)+ 
  ggtitle("Distribution of log2FC") +
  xlab("") +
  ylab("log2FC")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size=9)) + 
  stat_compare_means(aes(group = variable),label = "p.format", label.y = 8, method="wilcox", paired = F)
p
```

###If you want to change the column order it would be something simlar to:
```
boxplot_df$Set <- factor(boxplot_df$Set, levels=c("Upregulated Immune Response genes\n that occur in ISG (n=18)",
                                                  "All Genes\n (n=11364)", 
                                                  "Overlapping DE Genes\n (n=648)", 
                                                  "PAF1C-responsive ISGs\n (n=59)", 
                                                  "DE PAF1C-responsive ISGs\n (n=45)", 
                                                  "Upregulated Immune Response genes\n (n=64)"
                                                ))
```
###If you want to change the column names it would be somthing similar to:
```
levels(boxplot_df$Set) <- c(levels(boxplot_df$Set),"newname")
boxplot_df[boxplot_df$Set == "All Genes\n (n=11364)", ]$Set <- "newname"
```

###If you want to remove any columns it would be something simlar to:
```
boxplot_df <- boxplot_df[boxplot_df$Set != "All Genes\n (n=11364)",]
```

****************************************************************************************************

#Scatterplots
```{r}
load("scatterplot_df.Rdata")

to.plot <- scatterplot_df[scatterplot_df$GeneID %in% immune.64, ] #Upregulated Immune Response genes (n=64)

p <- ggplot(to.plot, aes(x=Log2FC_GFP, y=Log2FC_NS5)) +
  geom_point() +
  xlab("polyIC+GFP/GFP (log2 FC)")+
  ylab("polyIC+NS5/NS5 (log2 FC)")+
  geom_abline(intercept = 0, slope = 1, color="red", linetype="dashed", size=1.5) +
  ylim(c(-2,6)) + 
  xlim(-2,6) +
  ggtitle("Upregulated Response Genes (n=64)")
p
```

###If you want to plot any of the other columns pick from the list below
```
to.plot <- scatterplot_df #All Genes\n (n=11364)
to.plot <- scatterplot_df[scatterplot_df$GeneID %in% de.genes.648, ] #Overlapping DE Genes\n (n=648)
to.plot <- scatterplot_df[scatterplot_df$GeneID %in% isg.59, ] #PAF1C-responsive ISGs\n (n=59)
to.plot <- scatterplot_df[scatterplot_df$GeneID %in% isg.45, ] #DE PAF1C-responsive ISGs\n (n=45)
to.plot <- scatterplot_df[scatterplot_df$GeneID %in% immune.64, ] #Upregulated Immune Response genes\n (n=64)
to.plot <- scatterplot_df[scatterplot_df$GeneID %in% immune.18, ] #Upregulated Immune Response genes\n that occur in ISG (n=18)
```



****************************************************************************************************
#Barplots
- Use the same to.plot object as above
```{r}
a<- to.plot[,c(1,2)]
a$Treatment <- "GFP"
colnames(a) = c("GeneID", "Log2FC", "Treatment")

b<- to.plot[,c(1,4)]
b$Treatment <- "NS5"
colnames(b) = c("GeneID", "Log2FC", "Treatment")
res<- rbind(a,b)
res$GeneID <- as.factor(res$GeneID)

p <- ggplot(res, aes(x=GeneID, y=Log2FC, fill=Treatment))+
  geom_bar(stat="identity", position=position_dodge())+
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size=7))+
  ggtitle("Overlapping Upregulated Response Genes (n=64)") +
  NULL
p
```



```{r}
IRF3.dependent <- read.table("/Users/AEveritt/projects/AmpliSeq_Analysis/07_dengue_chip20.21/IRF3.dependent.txt")
IRF3.dependent <- read.table("/Users/AEveritt/projects/AmpliSeq_Analysis/07_dengue_chip20.21/IRF3.independent.txt")
to.plot <- scatterplot_df[scatterplot_df$GeneID %in% IRF3.dependent$V1, ] 
```

